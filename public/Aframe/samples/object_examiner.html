<!DOCTYPE html>
<html lang="en">
    <head>
        <title>three.js webgl - transform controls</title>
        <meta charset="utf-8" />
        <meta
            name="viewport"
            content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
        />
        <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    </head>
    <body>
        <div id="info">
            "W" translate | "E" rotate | "R" scale | "+/-" adjust size<br />
            "Q" toggle world/local space | "Shift" snap to grid<br />
            "X" toggle X | "Y" toggle Y | "Z" toggle Z | "Spacebar" toggle
            enabled<br />
            "C" toggle camera | "V" random zoom
        </div>

        <a-scene background="color: black" cursor="rayOrigin:mouse">
            <a-assets>
                <img
                    id="boxTexture"
                    src="https://i.imgur.com/mYmmbrp.jpg"
                    crossorigin="anonymous"
                />
                <img
                    id="groundTexture"
                    src="https://cdn.aframe.io/a-painter/images/floor.jpg"
                    crossorigin="anonymous"
                />
            </a-assets>

            <a-box
                color="red"
                position="0 2 -5"
                rotation="0 45 45"
                scale="2 2 2"
                animation__position="property: object3D.position.y; to: 2.2; dir: alternate; dur: 2000; loop: true"
                animation__mouseenter="property: scale; to: 2.3 2.3 2.3; dur: 300; startEvents: mouseenter"
                animation__mouseleave="property: scale; to: 2 2 2; dur: 300; startEvents: mouseleave"
            >
            </a-box>
            <a-light type="ambient" color="#445451"></a-light>
            <a-light type="point" intensity="2" position="2 4 4"></a-light>
            <a-plane
                src="#groundTexture"
                rotation="-90 0 0"
                height="100"
                width="100"
            ></a-plane>

            <a-text
                value="Hello and welcome to CoronaEscape!"
                color="#BBB"
                position="-2.9 1.0 -3"
                scale="1.5 1.5 1.5"
            ></a-text>

            <a-entity
                camera
                look-controls="enabled: false"
                wasd-controls
                position="0 1 0"
            >
            </a-entity>
        </a-scene>
        <script type="module">
            import { TransformControls } from "./TransformControls.js";

            // var changeEvent = { type: "change" };
            // var mouseDownEvent = { type: "mouseDown" };
            // var objectChangeEvent = { type: "objectChange" };

            let boxObj = document.querySelector("a-box");
            let boxObj3 = boxObj.object3D;
            let currRotation = boxObj3.rotation;
            // let camera = document.querySelector("a-entity[camera]");

            boxObj.addEventListener("mousedown", onPointerDown);
            boxObj.addEventListener("mouseup", onPointerUp);

            function onPointerDown(event) {
                console.log("POINTER DOWN --------------------", event);
                document.addEventListener("mousemove", onPointerHover);
            }

            function onPointerUp(event) {
                console.log("POINTER UP ----------------------", event);
                document.removeEventListener(`mousemove`, onPointerHover);
            }

            function onPointerHover(event) {
                const xV = new THREE.Vector3(1, 0, 0);
                const yV = new THREE.Vector3(0, 1, 0);
                boxObj3.rotateOnWorldAxis(yV, event.movementX / 250);
                boxObj3.rotateOnWorldAxis(xV, event.movementY / 250);
                // console.log("POINTER HOVER --------------------", event);
            }
        </script>

        <!--<script type="module">-->

        <!--    import { OrbitControls } from './OrbitControls.js';-->
        <!--    import { TransformControls } from './TransformControls.js';-->

        <!--    let cameraPersp, cameraOrtho, currentCamera;-->
        <!--    let scene, renderer, control, orbit;-->

        <!--    init();-->
        <!--    render();-->

        <!--    function init() {-->

        <!--        renderer = new THREE.WebGLRenderer();-->
        <!--        renderer.setPixelRatio( window.devicePixelRatio );-->
        <!--        renderer.setSize( window.innerWidth, window.innerHeight );-->
        <!--        document.body.appendChild( renderer.domElement );-->

        <!--        const aspect = window.innerWidth / window.innerHeight;-->

        <!--        cameraPersp = new THREE.PerspectiveCamera( 50, aspect, 0.01, 30000 );-->
        <!--        cameraOrtho = new THREE.OrthographicCamera( - 600 * aspect, 600 * aspect, 600, - 600, 0.01, 30000 );-->
        <!--        currentCamera = cameraPersp;-->

        <!--        currentCamera.position.set( 1000, 500, 1000 );-->
        <!--        currentCamera.lookAt( 0, 200, 0 );-->

        <!--        scene = document.querySelector('a-scene').object3D;-->
        <!--        scene.add( new THREE.GridHelper( 50, 25, 0x888888, 0x444444 ) );-->

        <!--        var boxObj = document.querySelector('a-box');-->
        <!--        boxObj.addEventListener("click", function() {-->
        <!--            console.log("CLICKEDDDDDDDD!!!!!!!!!!!!!!!!!!!!!");-->
        <!--        })-->

        <!--        const texture = new THREE.TextureLoader().load( 'textures/crate.gif', render );-->
        <!--        texture.anisotropy = renderer.capabilities.getMaxAnisotropy();-->

        <!--        const geometry = new THREE.BoxGeometry( 2, 2, 2 );-->
        <!--        const material = new THREE.MeshLambertMaterial( { map: texture, transparent: true } );-->

        <!--        orbit = new OrbitControls( currentCamera, renderer.domElement );-->
        <!--        orbit.update();-->
        <!--        orbit.addEventListener( 'change', render );-->

        <!--        control = new TransformControls( currentCamera, renderer.domElement );-->
        <!--        control.addEventListener( 'change', render );-->

        <!--        control.addEventListener( 'dragging-changed', function ( event ) {-->

        <!--            orbit.enabled = ! event.value;-->

        <!--        } );-->

        <!--        const mesh = new THREE.Mesh( geometry, material );-->
        <!--        scene.add( mesh );-->

        <!--        control.attach( mesh );-->
        <!--        // control.add( boxObj );-->
        <!--        scene.add( control );-->

        <!--        window.addEventListener( 'resize', onWindowResize );-->

        <!--        window.addEventListener( 'keydown', function ( event ) {-->

        <!--            switch ( event.keyCode ) {-->

        <!--                case 81: // Q-->
        <!--                    control.setSpace( control.space === "local" ? "world" : "local" );-->
        <!--                    break;-->

        <!--                case 16: // Shift-->
        <!--                    control.setTranslationSnap( 100 );-->
        <!--                    control.setRotationSnap( THREE.MathUtils.degToRad( 15 ) );-->
        <!--                    control.setScaleSnap( 0.25 );-->
        <!--                    break;-->

        <!--                case 87: // W-->
        <!--                    control.setMode( "translate" );-->
        <!--                    break;-->

        <!--                case 69: // E-->
        <!--                    control.setMode( "rotate" );-->
        <!--                    break;-->

        <!--                case 82: // R-->
        <!--                    control.setMode( "scale" );-->
        <!--                    break;-->

        <!--                case 67: // C-->
        <!--                    const position = currentCamera.position.clone();-->

        <!--                    currentCamera = currentCamera.isPerspectiveCamera ? cameraOrtho : cameraPersp;-->
        <!--                    currentCamera.position.copy( position );-->

        <!--                    orbit.object = currentCamera;-->
        <!--                    control.camera = currentCamera;-->

        <!--                    currentCamera.lookAt( orbit.target.x, orbit.target.y, orbit.target.z );-->
        <!--                    onWindowResize();-->
        <!--                    break;-->

        <!--                case 86: // V-->
        <!--                    const randomFoV = Math.random() + 0.1;-->
        <!--                    const randomZoom = Math.random() + 0.1;-->

        <!--                    cameraPersp.fov = randomFoV * 160;-->
        <!--                    cameraOrtho.bottom = - randomFoV * 500;-->
        <!--                    cameraOrtho.top = randomFoV * 500;-->

        <!--                    cameraPersp.zoom = randomZoom * 5;-->
        <!--                    cameraOrtho.zoom = randomZoom * 5;-->
        <!--                    onWindowResize();-->
        <!--                    break;-->

        <!--                case 187:-->
        <!--                case 107: // +, =, num+-->
        <!--                    control.setSize( control.size + 0.1 );-->
        <!--                    break;-->

        <!--                case 189:-->
        <!--                case 109: // -, _, num- -->
        <!--                    control.setSize( Math.max( control.size - 0.1, 0.1 ) );-->
        <!--                    break;-->

        <!--                case 88: // X-->
        <!--                    control.showX = ! control.showX;-->
        <!--                    break;-->

        <!--                case 89: // Y-->
        <!--                    control.showY = ! control.showY;-->
        <!--                    break;-->

        <!--                case 90: // Z-->
        <!--                    control.showZ = ! control.showZ;-->
        <!--                    break;-->

        <!--                case 32: // Spacebar-->
        <!--                    control.enabled = ! control.enabled;-->
        <!--                    break;-->

        <!--            }-->

        <!--        } );-->

        <!--        window.addEventListener( 'keyup', function ( event ) {-->

        <!--            switch ( event.keyCode ) {-->

        <!--                case 16: // Shift-->
        <!--                    control.setTranslationSnap( null );-->
        <!--                    control.setRotationSnap( null );-->
        <!--                    control.setScaleSnap( null );-->
        <!--                    break;-->

        <!--            }-->

        <!--        } );-->

        <!--    }-->

        <!--    function onWindowResize() {-->

        <!--        const aspect = window.innerWidth / window.innerHeight;-->

        <!--        cameraPersp.aspect = aspect;-->
        <!--        cameraPersp.updateProjectionMatrix();-->

        <!--        cameraOrtho.left = cameraOrtho.bottom * aspect;-->
        <!--        cameraOrtho.right = cameraOrtho.top * aspect;-->
        <!--        cameraOrtho.updateProjectionMatrix();-->

        <!--        renderer.setSize( window.innerWidth, window.innerHeight );-->

        <!--        render();-->

        <!--    }-->

        <!--    function render() {-->

        <!--        renderer.render( scene, currentCamera );-->

        <!--    }-->

        <!--</script>-->
    </body>
</html>
